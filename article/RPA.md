# RPA æœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–


## æ¦‚å¿µ

* PRA: Robotic process automationï¼Œå³ æœºå™¨äººæµç¨‹è‡ªåŠ¨åŒ–ã€‚

> wikipediaï¼šRobotic process automation (RPA) is a form of business process automation technology based on metaphorical software robots (bots) or on artificial intelligence (AI)/digital workers.[1] It is sometimes referred to as software robotics (not to be confused with robot software).

ç»´åŸºç™¾ç§‘çš„è§£é‡Šéå¸¸æ¨¡ç³Šã€‚

> æœºå™¨äººè¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼ˆRPAï¼‰æ˜¯ä¸€ç§è½¯ä»¶æŠ€æœ¯ï¼Œå®ƒä½¿æ„å»ºã€éƒ¨ç½²å’Œç®¡ç†è½¯ä»¶æœºå™¨äººå˜å¾—å®¹æ˜“ï¼Œè¿™äº›è½¯ä»¶æœºå™¨äººæ¨¡æ‹Ÿä¸æ•°å­—ç³»ç»Ÿå’Œè½¯ä»¶äº¤äº’çš„äººç±»åŠ¨ä½œã€‚å°±åƒäººä¸€æ ·ï¼Œè½¯ä»¶æœºå™¨äººå¯ä»¥ç†è§£å±å¹•ä¸Šçš„å†…å®¹ã€å®Œæˆæ­£ç¡®çš„å‡»é”®ã€å¯¼èˆªç³»ç»Ÿã€è¯†åˆ«å’Œæå–æ•°æ®ï¼Œä»¥åŠæ‰§è¡Œå„ç§å®šä¹‰çš„æ“ä½œã€‚è½¯ä»¶æœºå™¨äººå¯ä»¥æ¯”äººæ›´å¿«ã€æ›´ç¨³å®šåœ°å®Œæˆè¿™é¡¹å·¥ä½œï¼Œä¸éœ€è¦ç«™èµ·æ¥ä¼¸å±•ä¸€ä¸‹èº«ä½“æˆ–å–æ¯å’–å•¡ä¼‘æ¯ä¸€ä¸‹ã€‚

å¥½åƒæ˜ç™½äº†ï¼Œåˆå¥½åƒæ²¡å¤ªæ‡‚ã€‚

![](./images/ali_rpa.png)

é˜¿é‡Œçš„RPAæ¡ˆä¾‹è®²çš„æ¯”è¾ƒæ¸…æ¥šã€‚

ç›¸ä¿¡ç©æ¸¸æˆçš„åŒå­¦éƒ½æ‰§è¡Œæ¸¸æˆå¤–æŒ‚ï¼Œæ¸¸æˆé‡Œé¢æœ‰å¾ˆå¤šå¤§é‡é‡å¤çš„æ“ä½œï¼Œæ¯”å¦‚åˆ·æ€ªï¼Œè·‘å•†ï¼Œæ—¥å¸¸ä»»åŠ¡ç­‰ï¼Œå¯ä»¥é€šè¿‡æ¸¸æˆå¤–æŒ‚è‡ªåŠ¨çš„å¸®ä½ å®Œæˆè¿™äº›æ“ä½œã€‚

é‚£ä¹ˆæˆ‘ä»¬åœ¨æ—¥å¸¸å·¥ä½œä¸­å…¶å®ä¹Ÿæœ‰å¤§é‡é‡å¤çš„å·¥ä½œï¼Œæ¯”å¦‚æ—©ä¸Šä¸€åˆ°å…¬å¸å…ˆç™»å½•æ²Ÿé€šå·¥å…·ï¼ŒæŸ¥çœ‹ä¸€ä¸‹é‚®ä»¶ï¼Œç„¶åï¼Œæé†’å®¢æˆ·å°¾æ¬¾æ—¶é—´ç­‰ç­‰ã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä¸ªäººç†è§£ï¼š

* RPAåº”è¯¥æ˜¯æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œçš„ï¼Œä»–å¹¶ä¸æ˜¯è½¯ä»¶æœ¬èº«å¸®ä½ ç®€åŒ–äº†æµç¨‹ã€‚æ¯”å¦‚ï¼Œæˆ‘é€šè¿‡OAç³»ç»Ÿè¯·å‡ï¼Œä»¥å‰è¦ç»è¿‡5ä¸ªæ­¥éª¤ã€‚ç°åœ¨ï¼Œå¹¶ä¸æ˜¯OAç³»ç»Ÿæœ¬èº«ç®€åŒ–äº†æµç¨‹ï¼Œåªéœ€è¦ä¸€æ­¥æå®šï¼›è€Œæ˜¯ç”±ä¸€ä¸ªæœºå™¨äººï¼Œè‡ªåŠ¨çš„å¸®æˆ‘å®Œæˆè¿™5ä¸ªæ­¥éª¤ï¼Œè€Œä¸”ï¼Œä½ å¯ä»¥çœ‹åˆ°ä»–æ“ä½œ5æ­¥çš„è¿‡ç¨‹ã€‚

* RPAåº”è¯¥æ˜¯è·¨åº”ç”¨è½¯ä»¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–å¯ä»¥åœ¨ä¸åŒçš„åº”ç”¨è½¯ä»¶ä¹‹é—´è¿›è¡Œæ“ä½œã€‚æ¯”å¦‚ï¼Œæ‰“å¼€æµè§ˆå™¨å¤åˆ¶å•†å“é“¾æ¥ï¼Œé€šè¿‡æ²Ÿé€šå·¥å…·å‘é€ç»™å®¢æˆ·ï¼Œå†æ‰“å¼€excelè®°å½•å®¢æˆ·çš„é‡è¦ä¿¡æ¯ã€‚

* RPAåº”è¯¥æ›´åŠ æ™ºèƒ½ï¼Œæ¯”ä¼ ç»Ÿçš„è‡ªåŠ¨åŒ–å·¥å…·æ›´åŠ æ™ºèƒ½ã€‚ 

## RPA-python

æ¥ä¸‹æ¥ï¼Œä»‹ç»ä¸€ä¸ªå¼€æºRPAå·¥å…·ã€‚

https://github.com/tebelorg/RPA-Python

æ¥çœ‹çœ‹ï¼Œä»–æä¾›äº†å“ªäº›åŠŸèƒ½ï¼Œå½“ç„¶ï¼Œé¦–å…ˆå£°æ˜ï¼Œä»–å¯¹æ¯”ä¼ä¸šçº§çš„RPAå·¥å…·è¿˜æ˜¯ç®€å•å¾ˆå¤šçš„ã€‚

* pip å®‰è£…


```shel
> pip install rpa
```

* åˆå§‹åŒ–ç¯å¢ƒ

```py
> import rpa as r
> r.init()

[RPA][INFO] - setting up TagUI for use in your Python environment
[RPA][INFO] - downloading TagUI (~200MB) and unzipping to below folder...
[RPA][INFO] - C:\Users\fnngj\AppData\Roaming
[RPA][INFO] - done. syncing TagUI with stable cutting edge version
[RPA][INFO] - now installing missing Visual C++ Redistributable dependency
[RPA][INFO] - MSVCR110.dll is still missing, install vcredist_x86.exe from
[RPA][INFO] - the vcredist_x86.exe file in C:\Users\fnngj\AppData\Roaming\tagui or from
[RPA][INFO] - https://www.microsoft.com/en-us/download/details.aspx?id=30679
[RPA][INFO] - after that, TagUI ready for use in your Python environment
...
```

> æˆ‘å®‰è£…è¿‡ç¨‹å‡ºç°äº†ï¼Œç¼ºå°‘ MSVCP110.dllï¼Œåœ¨ https://www.dll-files.com/ ç½‘ç«™æ‰¾åˆ°äº†ç¼ºå¤±çš„æ–‡ä»¶ï¼Œä¸‹è½½è§£å‹ï¼Œæ”¾åˆ°`C:\Windows\system32\` é‡å¯ç”µè„‘ã€‚

## åº”ç”¨åœºæ™¯

* WEB AUTOMATION ğŸ•¸ï¸

```py
import rpa as r

r.init()
r.url('https://www.google.com')
r.type('//*[@name="q"]', 'decentralization[enter]')
print(r.read('result-stats'))
r.snap('page', 'results.png')
r.close()
```

è¿™ä¸ªä¾‹å­å’Œselenium éå¸¸ç±»ä¼¼ï¼Œé€šè¿‡å…ƒç´ å±æ€§å®šä½å¹¶æ“ä½œã€‚


* VISUAL AUTOMATION ğŸ™ˆ

```py
import rpa as r

r.init(visual_automation = True)
r.url('https://www.baidu.com')

r.type('search.png', 'message')
r.click('search_button.png')
r.close()
```

è¿™ä¸ªä¾‹å­å’Œsikuliç±»ä¼¼ï¼Œéœ€è¦é¢„å…ˆæŠŠæ“ä½œçš„å…ƒç´ è¿›è¡Œæˆªå›¾ï¼Œç„¶ååŸºäºå›¾ç‰‡è¿›è¡Œæ“ä½œã€‚


* OCR AUTOMATION ğŸ§¿

```py
import rpa as r

r.init(visual_automation = True, chrome_browser = False)
print(r.read('windows.png'))
print(r.read('image_preview.png'))
r.hover('anchor_element.png')
print(r.read(r.mouse_x(), r.mouse_y(), r.mouse_x() + 400, r.mouse_y() + 200))
r.close()
```

> ç§‘æ™®ï¼ŒOCR: Optical Character Recognitionï¼Œå³å…‰å­¦å­—ç¬¦è¯†åˆ«ï¼Œ æ˜¯æŒ‡ç”µå­è®¾å¤‡æ£€æŸ¥çº¸ä¸Šæ‰“å°çš„å­—ç¬¦ï¼Œé€šè¿‡æ£€æµ‹æš—ã€äº®çš„æ¨¡å¼ç¡®å®šå…¶å½¢çŠ¶ï¼Œç„¶åç”¨å­—ç¬¦è¯†åˆ«æ–¹æ³•å°†å½¢çŠ¶ç¿»è¯‘æˆè®¡ç®—æœºæ–‡å­—çš„è¿‡ç¨‹ã€‚

é¦–å…ˆï¼Œè¿™ä¸ªä¾‹å­ä¸éœ€è¦å¯åŠ¨æµè§ˆå™¨ï¼Œ`chrome_browser = False`.

å…¶æ¬¡ï¼Œä½ å¯ä»¥æˆªå›¾ä¸€æ®µæ–‡å­—ä¿å­˜ä¸ºå›¾ç‰‡`windows.png`ï¼Œ`r.read()` è¯•ç€è¯»å–å›¾ç‰‡ä¸Šçš„æ–‡å­—ï¼Œå¹¶æ‰“å°ã€‚

æˆ–è€…ï¼Œä½¿ç”¨`r.mouse_x()` å’Œ `r.mouse_y()` è¯»å–ä½ é¼ æ ‡çš„çš„ä½ç½®ï¼Œåœ¨è¿è¡Œè„šæœ¬çš„è¿‡ç¨‹å½“ä¸­è¯»å–ä½ é¼ æ ‡ä½ç½®çš„å†…å®¹ã€‚

* KEYBOARD AUTOMATIONâ€‚ğŸ¹

```py
import rpa as r

r.init(visual_automation = True, chrome_browser = False)
r.keyboard('[alt][space]')
r.keyboard('chrome[enter]')
r.keyboard('[alt]t')
r.keyboard('mortal kombat[enter]')
r.wait(2.5)
r.snap('page.png', 'results.png')
r.close()
```

è¿™ä¸ªä¾‹å­å¾ˆå¥½ç†è§£ï¼Œæ¨¡æ‹Ÿé”®ç›˜æ“ä½œï¼Œalt + space æ˜¯æˆ‘è°ƒå¯utools å·¥å…·çš„å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ chrome æ•²enter...

* MOUSE AUTOMATIONâ€‚ğŸ­


```py
import rpa as r

r.init(visual_automation = True)
r.type(600, 300, 'open source')
r.click(900, 300)
r.snap('page.png', 'results.png')
r.hover('button_to_drag.png')
r.mouse('down')
r.hover(r.mouse_x() + 300, r.mouse_y())
r.mouse('up')
r.close()
```

æ¨¡æ‹Ÿé¼ æ ‡è¿›è¡Œæ“ä½œã€‚å½“ç„¶ï¼Œè¿™äº›APIéƒ½æ˜¯å¯ä»¥æ··ç”¨çš„ï¼Œä¾‹å¦‚ï¼Œ`type()` æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªwebå…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œè¿˜å¯ä»¥æ˜¯å±å¹•æ¡Œæ ‡ä½ç½®ã€‚


